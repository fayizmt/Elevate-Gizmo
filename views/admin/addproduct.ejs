<%-include ('../layouts/adminHeader.ejs') %>

<style>
    .image-preview-container {
        display: flex;
        flex-wrap: wrap;
        gap: 10px; /* Add some spacing between previews */
        max-width: 100%; /* Set maximum width to ensure responsiveness */
         
    }
  
    .image-preview {
        width: 100%; /* Occupy full width of the container */
        max-width: 150px; /* Set a maximum width */
        height: 150px; /* Allow the height to adjust accordingly */
        position: relative;
    }
  
    .image-preview img {
        width: 100%; /* Ensure the image takes the full width */
        height: 100%; /* Ensure the image takes the full height */
        object-fit: cover;
    }
    
    .form-group {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }
  
    .image-input {
      flex: 1;
      /* Optional: Center align text */
      position: relative;
    }
  
    .image-preview.plus-sign {
      display: flex;
      align-items: center;
      justify-content: center;
    }
  
    .image-preview img {
      max-width: 100%;
      max-height: 100%;
      object-fit: cover;
    }
  
    /* Media query for smaller screens */
    @media screen and (max-width: 600px) {
      .image-preview {
        max-width: calc(50% - 10px); /* Adjust as needed for smaller screens */
      }
    }
  </style>
<body>
     
        <div class="screen-overlay"></div>
       
            <%-include ('../layouts/adminSideBar.ejs') %>
        </aside>
        <main class="main-wrap">
            <header class="main-header navbar">
                <div class="col-search">
                    <form class="searchform">
                        <div class="input-group">
                            <input list="search_terms" type="text" class="form-control" placeholder="Search term" />
                            <button class="btn btn-light bg" type="button"><i class="material-icons md-search"></i></button>
                        </div>
                        <datalist id="search_terms">
                            <option value="Products"></option>
                            <option value="New orders"></option>
                            <option value="Apple iphone"></option>
                            <option value="Ahmed Hassan"></option>
                        </datalist>
                    </form>
                </div>
                <div class="col-nav">
                    <button class="btn btn-icon btn-mobile me-auto" data-trigger="#offcanvas_aside"><i class="material-icons md-apps"></i></button>
                    <ul class="nav">
                        <li class="nav-item">
                            <a class="nav-link btn-icon" href="#">
                                <i class="material-icons md-notifications animation-shake"></i>
                                <span class="badge rounded-pill">3</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link btn-icon darkmode" href="#"> <i class="material-icons md-nights_stay"></i> </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="requestfullscreen nav-link btn-icon"><i class="material-icons md-cast"></i></a>
                        </li>
                        <li class="dropdown nav-item">
                            <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownLanguage" aria-expanded="false"><i class="material-icons md-public"></i></a>
                            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownLanguage">
                                <a class="dropdown-item text-brand" href="#"><img src="/public/assets/imgs/theme/flag-us.png" alt="English" />English</a>
                                <a class="dropdown-item" href="#"><img src="/public/assets/imgs/theme/flag-fr.png" alt="Français" />Français</a>
                                <a class="dropdown-item" href="#"><img src="/public/assets/imgs/theme/flag-jp.png" alt="Français" />日本語</a>
                                <a class="dropdown-item" href="#"><img src="/public/assets/imgs/theme/flag-cn.png" alt="Français" />中国人</a>
                            </div>
                        </li>
                        <li class="dropdown nav-item">
                            <a class="dropdown-toggle" data-bs-toggle="dropdown" href="#" id="dropdownAccount" aria-expanded="false"> <img class="img-xs rounded-circle" src="/public/assets/imgs/people/avatar-2.png" alt="User" /></a>
                            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownAccount">
                                <a class="dropdown-item" href="#"><i class="material-icons md-perm_identity"></i>Edit Profile</a>
                                <a class="dropdown-item" href="#"><i class="material-icons md-settings"></i>Account Settings</a>
                                <a class="dropdown-item" href="#"><i class="material-icons md-account_balance_wallet"></i>Wallet</a>
                                <a class="dropdown-item" href="#"><i class="material-icons md-receipt"></i>Billing</a>
                                <a class="dropdown-item" href="#"><i class="material-icons md-help_outline"></i>Help center</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item text-danger" href="#"><i class="material-icons md-exit_to_app"></i>Logout</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </header>

   
            <section class="content-main py-4">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-12 col-md-9">
                            <div class="content-header">
                                <h2 class="content-title">Add New Product</h2>
                            </div>
                        </div>
                        <div class="col-12 col-md-12">
                            <div class="card">
                                <div class="card-body">
                                    <form class="forms-sample" action="" method="post" enctype="multipart/form-data">
                                        <div class="form-group">
                                          <label for="productName" class="form-label">Product Name</label>
                                          <input type="text" class="form-control" id="productName" name="productName" value="" required>
                                          <div id="productNameError" class="error-message text-danger"></div>
                                        </div>
                                        <div class="form-group">
                                          <label for="description" class="form-label">Description</label>
                                          <input type="text" class="form-control" id="description" name="description" value="" required>
                                        </div>
                                        <div class="form-group">
                                          <label for="color" class="form-label">Color</label>
                                          <input type="text" class="form-control" id="color" name="color" value="" required>
                                        </div>
                                        <div class="form-group">
                                          <label for="price" class="form-label">Offer Price</label>
                                          <input type="number" class="form-control" id="price" name="price" value="" required>
                                          <div id="priceError" class="error-message text-danger"></div>
                                        </div>
                                        <div class="form-group">
                                            <label for="Actual price" class="form-label">Price</label>
                                            <input type="number" class="form-control" id="actualPrice" name="actualPrice" value="" required>
                                            <div id="priceError" class="error-message text-danger"></div>
                                          </div>
                      
                          <div class="form-group">
                                          <label for="category" class="form-label">Category</label>
                                          <select class="form-control" id="category" name="category" required>
                                            <option value="" disabled selected>Select category</option>
                                            <% categoryList.forEach(category => { %>
                                              <option value="<%= category._id %>"><%= category.category %></option>
                                            <% }); %>
                                          </select>
                                        </div>
                      
                      
                          <div class="form-group">
                            <label for="quantity" class="form-label">Quantity</label>
                            <input type="number" class="form-control" id="quantity" name="quantity" value="" required>
                            <div id="quantityError" class="error-message text-danger"></div>
                          </div>
                          <div class="form-group picContainer">
                            <div class="image-input" onclick="handleImageClick(event, 1)">
                                <label for="coverPic1">Cover Pic</label>
                                <div id="preview1" class="image-preview plus-sign"><img src="https://static.vecteezy.com/system/resources/previews/009/266/327/original/plus-sign-icon-free-png.png" alt=""></div>
                                <input type="file" name="images" id="coverPic1" accept="image/*" style="display: none;" onchange="previewImage(this, 'preview1')">
                            </div>
                        
                            <!-- Repeat the following block for each additional input -->
                            <!-- You can set the maximum number of inputs (e.g., 10) based on your requirement -->
                            <div class="image-input" id="imageInput2" onclick="handleImageClick(event, 2)">
                                <label for="coverPic2">Product Image 1</label>
                                <div id="preview2" class="image-preview plus-sign"><img src="https://static.vecteezy.com/system/resources/previews/009/266/327/original/plus-sign-icon-free-png.png" alt=""></div>
                                <input type="file" name="images" id="coverPic2" accept="image/*" style="display: none;" onchange="previewImage(this, 'preview2')">
                                <button type="button" class="btn btn-danger m-3 btn-sm" onclick="removeInput(2)">Remove</button>
                            </div>
                        </div>
                       
                          
                      
                         
                      
                         
                      
                          <!-- Repeat this block for each cover pic input -->
                          <button type="submit" class="btn btn-primary mr-2">Add Product</button>
                                     </form>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <script>
let currentIndex = 2; // Start with the index of the last existing input

function handleImageClick(event, index) {
    const coverPicInput = document.getElementById(`coverPic${index}`);
    coverPicInput.click();
}

function previewImage(input, previewId) {
    const previewContainer = document.getElementById(previewId);
    if (previewContainer) {
        previewContainer.innerHTML = ''; // Clear previous preview

        const file = input.files[0];
        if (file) {
            const reader = new FileReader();

            reader.onload = function (e) {
                const image = document.createElement('img');
                image.src = e.target.result;
                image.classList.add('img-fluid');

                previewContainer.appendChild(image);
                previewContainer.classList.remove('plus-sign');
            };

            reader.readAsDataURL(file);
        }
    }

    // Check if the current index is less than or equal to the maximum index (e.g., 10)
    if (currentIndex <= 10) {
        currentIndex++;
        addNewInput();
    }
}

function addNewInput() {
    const formGroup = document.querySelector('.picContainer');

    const newIndex = currentIndex;
    const newInput = document.createElement('div');
    newInput.classList.add('image-input');
    newInput.setAttribute('id', `imageInput${newIndex}`);
    newInput.setAttribute('onclick', `handleImageClick(event, ${newIndex})`);

    newInput.innerHTML = `
        <label for="coverPic${newIndex}">Product Image ${newIndex - 1}</label>
        <div id="preview${newIndex}" class="image-preview plus-sign"><img src="https://static.vecteezy.com/system/resources/previews/009/266/327/original/plus-sign-icon-free-png.png" alt=""></div>
        <input type="file" name="images" id="coverPic${newIndex}" accept="image/*" style="display: none;" onchange="previewImage(this, 'preview${newIndex}')">
        <button type="button" class="btn btn-danger m-3 btn-sm" onclick="removeInput(${newIndex})">Remove</button>
    `;

    formGroup.appendChild(newInput);
}

function removeInput(index) {
    const formGroup = document.querySelector('.picContainer');
    const inputToRemove = document.getElementById(`imageInput${index}`);
    formGroup.removeChild(inputToRemove);
}

document.getElementById('addButton').addEventListener('click', addNewInput);


              </script>
            
<%-include ('../layouts/adminFooter.ejs') %>
